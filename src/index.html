<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>WEBPACK DLL • DEMO</title>
</head>

<body>
  <style>
    body {
      margin: 0;
    }

    .___loading-box {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  </style>

  <app-root id="app-root">
    <div class="___loading-box">
      <svg width="64" height="64" viewBox="0 0 38 38" xmlns="http://www.w3.org/2000/svg" stroke="#ccc">
        <g fill="none" fill-rule="evenodd">
          <g transform="translate(1 1)" stroke-width="2">
            <circle stroke-opacity=".5" cx="18" cy="18" r="18" />
            <path d="M36 18c0-9.94-8.06-18-18-18">
              <animateTransform attributeName="transform" type="rotate" from="0 18 18" to="360 18 18" dur="1s" repeatCount="indefinite"
              />
            </path>
          </g>
        </g>
      </svg>
    </div>

  </app-root>

  <script>
    /* js 加载会阻塞 gif svg 的动画, 使用异步加载来解决这个问题 */
    setTimeout(load, 0);

    function load() {
      const jsArr = <%= JSON.stringify(htmlWebpackPlugin.files.js) %>;
      const vendor = { path: "<%= htmlWebpackPlugin.options.dll %>" };
      loadScript(vendor).then(loadEntry);
      function loadEntry() {
        jsArr.forEach(loadScript)
      }
      function loadScript(data) {
        return new Promise((resolve, reject) => {
          const js = document.createElement('SCRIPT')
          js.src = data.path;
          document.head.appendChild(js);
          js.onload = resolve;
          js.onerror = reject;
        })
      }
    }
  </script>
</body>

</html>